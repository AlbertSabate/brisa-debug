var h=(Z=[])=>Z.join("/"),f=(Z)=>Z.split("/");function n(Z,B,W){let j=new URL(B,"http://l"),x=f(j.pathname);for(let[R,v]of Object.entries(Z)){let A=function(){let $=v[W]??R,G=F.r??[],y=h(f($).map((J,Y)=>q.has(Y)?G.shift():J));return(C&&x.length>Q?`${y}/${h(x.slice(Q))}`:y)+j.search+j.hash},k=f(R),C=k.at(-1)?.includes("[..."),q=new Set,Q=k.length,H=Q-1;for(let $=0;$<Q;$++)if(k[$].startsWith("["))q.add($);let F=Object.groupBy(x,($,G)=>q.has(G)||!(C&&G<H)&&C?"r":"k"),M=($,G)=>!q.has(G),U=h(F.k),T=h(k.filter(M));if(U===T)return A();if(Object.values(v).some(($)=>h(f($).filter(M))===U))return A()}}function r(Z,B){while(Z){if(Z.tagName==="CONTEXT-PROVIDER"&&B===Z.getAttribute("cid")){let W=Z.getAttribute("pid");if(W)return W}Z=Z.assignedSlot??Z.host??Z.parentNode}return null}function BJ(Z){return typeof Z!=="object"?Z:JSON.stringify(Z,(B,W)=>W===void 0?"_|U|_":W)}function l(Z){if(!Z)return Z;try{return JSON.parse(Z,(B,W)=>W==="_|U|_"?void 0:W)}catch(B){return Z}}var a=window,g=a._s??={Map:new Map};for(let[Z,B]of a._S??[])g.Map.set(Z,B);var s=a.sub??=xJ();for(let Z of["get","set","delete"])g[Z]=(B,W)=>{let j=g.Map[Z](B,W);return s.n(B,W,Z==="get"),j};function d(){let Z=[],B=new Map,W=(J,Y)=>J.get(Y)??new Set,j=new Map,x=new Map,R=new Map,v=!1;function k(J,Y,X){let D=B.get(J)??F(Y);X?D.value:D.value=Y,B.set(J,D)}function C(J){let Y=Z.indexOf(J);if(Y>-1)Z.splice(Y,1)}function q(J){let Y=W(x,J);for(let X of Y)X();x.delete(J)}function Q(J){let Y=(X)=>{let D=W(R,J);return D.add(X),R.set(J,D),X};return Y.id=J,Y}function H(J){let Y=W(R,J);for(let X of Y){q(X),H(X);for(let D of j.keys()){let O=j.get(D);if(O.delete(X),O.size===0)j.delete(D)}}R.delete(J)}function F(J){return{get value(){if(Z[0])j.set(this,W(j,this).add(Z[0]));return J},set value(Y){let X=Y===J&&Y!=null;if(J=Y,X)return;let D=W(j,this),O=new Set(D);for(let I of D){if(I===Z[0])continue;if(O.has(I))H(I),q(I),M(I)}}}}async function M(J){Z.unshift(J);let Y=J(Q(J));if(Y?.then)await Y;C(J)}function A(){for(let J of x.keys())q(J);x.clear(),j.clear(),R.clear(),U(!1)}function U(J=!0){if(v===J)return;v=J,s[J?"s":"u"](k)}function T(J,Y){let X=W(x,Y);X.add(J),x.set(Y,X)}function $(J){let Y=F();return M(()=>{Y.value=J()}),Y}let G={...g,setOptimistic(J,Y,X){let D="__ind:"+J,O="__o:"+Y,I=G.get(Y),K=X(I);G.set(D,!0),G.set(O,K),M(()=>{if(!G.get(D)&&G.get(Y)===K)G.delete(O)})},get(J){return U(),g.get("__o:"+J)??g.get(J)},has(J){return G.get(J)!==void 0}};function y(J){let Y="__ind:"+J,X=$(()=>!!G.get(Y));return X.id=Y,X.error=$(()=>G.get("e"+Y)),X}return{state:F,store:G,effect:M,reset:A,cleanup:T,derived:$,indicate:y}}function xJ(){let Z=new Set;return{["s"](B){Z.add(B)},["n"](...B){for(let W of Z)W(...B)},["u"](B){Z.delete(B)}}}var m=(Z)=>Z.toLowerCase();function t(Z){let B="";for(let W in Z){let j=m(W.replace(/([A-Z])/g,"-$1"));B+=`${j}:${Z[W]};`}return B}var KJ=Symbol("on"),zJ=Symbol("off"),MJ="http://www.w3.org/",e=MJ+"2000/svg",DJ=MJ+"1999/xlink",YJ="HTML",HJ="indicator",UJ="brisa-request",RJ="portal",JJ="slot",$J="key",XJ="connectedCallback",jJ="dis"+XJ,ZJ="inner"+YJ,FJ="p",c="l",S=null,TJ="context",IJ=(Z)=>typeof Z==="object",i=(Z)=>Z?.some?.(IJ),qJ=Array.from,GJ=(Z)=>Z instanceof CustomEvent,p=(Z)=>typeof Z==="function",QJ=(Z)=>Z.startsWith("on"),b=(Z,B)=>Z.appendChild(B);function _J(Z,B=[]){let W=document,j=window,x=(q)=>{if(q===!1)q="";return W.createTextNode((Array.isArray(q)?q.join(""):q??"").toString())};if(__TRAILING_SLASH__||__USE_LOCALE__||__USE_PAGE_TRANSLATION__)j.fPath??=(q)=>{let Q=q;if(__USE_LOCALE__||__USE_PAGE_TRANSLATION__){let{locales:F,locale:M,pages:A}=j.i18n,U=Q.split(/\/|#|\?/)[1],T=F.includes(U);if(__USE_PAGE_TRANSLATION__){let $=n(A,Q,T?U:M);if($)Q=$}Q=T?Q:"/"+M+Q}let H=/\/(?=\?|#|$)/;if(__TRAILING_SLASH__){if(Q=Q.replace(/([^/])([?#])/,"$1/$2"),!Q.match(H))Q+="/"}else Q=Q.replace(H,"");return Q};let R=(q,Q)=>{return q==="svg"||Q?.namespaceURI===e&&m(Q.tagName)!=="foreignobject"?W.createElementNS(e,q):W.createElement(q)},v=(q,Q,H)=>{let F=H===KJ,M=H===zJ,U=Q==="style"&&IJ(H)?t(H):BJ(H);if(U===void 0)return;let T=q.namespaceURI===e&&(Q.startsWith("xlink:")||Q==="href");if(__BASE_PATH__||__TRAILING_SLASH__||__USE_LOCALE__||__USE_PAGE_TRANSLATION__||__ASSET_PREFIX__){if((Q==="src"||Q==="href")&&!URL.canParse(U)){if((__TRAILING_SLASH__||__USE_LOCALE__||__USE_PAGE_TRANSLATION__)&&Q==="href")U=j.fPath(U);if(__ASSET_PREFIX__&&Q==="src")U=__ASSET_PREFIX__+U;if(__BASE_PATH__&&!URL.canParse(U))U=__BASE_PATH__+U}}if(Q===HJ)if(H)q.classList.add(UJ);else q.classList.remove(UJ);else if(Q==="ref")H.value=q;else if(T)if(M)q.removeAttributeNS(DJ,Q);else q.setAttributeNS(DJ,Q,F?"":U);else if(M)q.removeAttribute(Q);else q.setAttribute(Q,F?"":U)},k=[],C={};B.push($J);for(let q of B){let Q=m(q);C[Q]=C[q]=q,k.push(Q)}return class extends HTMLElement{p;l;s;static get observedAttributes(){return k}static formAssociated=!0;async[XJ](){let q=this,Q=q.shadowRoot??q.attachShadow({mode:"open"}),H=[],F=[],M=new CSSStyleSheet,A=0,U=[];for(let J of W.styleSheets)try{for(let Y of J.cssRules)U.push(Y.cssText)}catch(Y){U.push(`@import url('${J.href}');`)}M.replaceSync(U.join("")),Q.adoptedStyleSheets.push(M);function T(J,Y){if(J?.[0]!==RJ)return[J,Y];let{element:X,target:D}=J[1];return[X,D]}async function $(J,Y,X,D,O,I,K=!1){if(X?.then)X=await X;if(K){if(q.shadowRoot)q.shadowRoot[ZJ]="";if(F.length){let _=R("style");I(()=>{let w="";for(let[P,...V]of F)w+=String.raw(P,...V.map((L)=>p(L)?L():L));_.textContent=w}),b(Q,_)}}[X,D]=T(X,D);let z=J?R(J,D):D;for(let[_,w]of Object.entries(Y)){let P=QJ(_),V=_===HJ;if(P)z.addEventListener(m(_.slice(2)),(L)=>w.apply(null,GJ(L)?L.detail:[L]));else if(V||!P&&p(w))I(O(()=>v(z,_,V?w?.value:w())));else v(z,_,w)}if(X?.[0]===YJ)z[ZJ]+=X[1].html;else if(X===JJ)b(z,R(JJ));else if(i(X))if(i(X[0]))for(let _ of X)$(S,{},_,z,O,I);else $(...X,z,O,I);else if(p(X)){let _,w=(P)=>{if(_&&z.contains(_[0])){z.insertBefore(P,_[0]);for(let V of _)V?.remove()}else b(z,P)};I(O((P)=>{let V=X();function L(N){[N,z]=T(N,z);let WJ=N?.[0]===YJ;if(WJ||i(N)){let o=qJ(z.childNodes),u=W.createDocumentFragment();if(WJ){let E=R("p");E[ZJ]+=N[1].html;for(let OJ of qJ(E.childNodes))b(u,OJ)}else if(i(N[0]))for(let E of N)$(S,{},E,u,O(P),I);else if(N.length)$(...N,u,O(P),I);w(u),_=qJ(z.childNodes).filter((E)=>!o.includes(E))}else{let o=x(N);w(o),_=[o]}}if(V instanceof Promise)V.then(L);else L(V)}))}else b(z,x(X));if(J)b(D,z)}let G=(J,Y,X=d(),D=FJ)=>{q.s=X,q[D]={};for(let K of B)q[D][C[K]]=QJ(K)?q.e(K):X.state(l(q.getAttribute(K)));let O={children:[JJ,{},S],...q[D],...Y},I={...X,onMount(K){H.push(K)},useId(){return q.dataset[`id-${++A}`]??crypto.randomUUID()},useContext(K){return X.derived(()=>{let z=r(q,K.id);return z?X.store.get(`${TJ}:${K.id}:${z}`):K.defaultValue})},css(K,...z){F.push([K,...z])},i18n:j.i18n,route:j.r,self:q};if(__WEB_CONTEXT_PLUGINS__)for(let K of j._P)Object.assign(I,K(I));return F.length=0,$(S,{},J(O,I),Q,(K)=>K,X.effect,!0)},y=d();try{if(p(Z.suspense))await G(Z.suspense,S,y,c);await G(Z),y.reset(),delete q[c]}catch(J){if(y.reset(),q.s.reset(),p(Z.error))G(Z.error,{error:q.s.state(J)});else throw J}for(let J of H)J()}[jJ](){this.s?.reset()}e(q){return(...Q)=>{let H=new CustomEvent(m(q.slice(2)),{detail:GJ(Q?.[0])?Q[0].detail:Q});this.dispatchEvent(H)}}attributeChangedCallback(q,Q,H){let F=this,M=F[c]?c:FJ;if(q===$J&&Q!=S&&Q!==H)F[jJ](),F[XJ]();if(F[M]&&Q!==H&&!QJ(q))F[M][C[q]].value=l(H)}}}export{_J as brisaElement,KJ as _on,zJ as _off};
